<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>TwoStepSDFM</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">TwoStepSDFM</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#library(TwoStepSDFM)</span></span></code></pre></div>
<div id="twostepsdfm" class="section level1">
<h1>TwoStepSDFM</h1>
<p>A <code>C++</code>-backed <code>R</code> implementation of the
two-step estimation procedure for a <i>Sparse Dynamic Factor Model</i>
(SDFM), as outlined in <span class="citation">Franjic and Schweikert
(2024)</span>.</p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <code>TwoStepSDFM</code> package provides a fast implementation
of the Kalman Filter and Smoother (KFS) <span class="citation">(Koopman
and Durbin 2000)</span> to estimate factors in a mixed-frequency SDFM
framework, explicitly accounting for cross-sectional correlation in the
measurement error. The KFS is initialized using results from Sparse
Principal Components Analysis (SPCA) by <span class="citation">Zou,
Hastie, and Tibshirani (2006)</span> in a preliminary step. This
approach generalizes the two-step estimator for approximate dynamic
factor models by <span class="citation">Giannone, Reichlin, and Small
(2008)</span> and <span class="citation">Doz, Giannone, and Reichlin
(2011)</span>.</p>
<p>We estimate the loadings matrix <span class="math inline">\(\mathbf{\Lambda}\)</span> and factors <span class="math inline">\(\mathbf{f}_t\)</span> of the following
state-space-model</p>
<p><span class="math display">\[\begin{align*}
\mathbf{x}_{t} &amp;= \boldsymbol{\Lambda}\mathbf{f}_t +
\boldsymbol{\xi}_t,\notag\\
    \mathbf{f}_{t} &amp;= \sum_{p=1}^P
\boldsymbol{\Phi}_p\mathbf{f}_{t-p} + \mathbf{\epsilon}_t,
\end{align*}\]</span> for <span class="math inline">\(t=1,\dots,T\)</span>. We use SPCA to estimate
<span class="math inline">\(\boldsymbol{\Lambda}\)</span>. Given the
degree of regularisation induced by the SPCA algorithm, this results in
exact zero elements of the loadings matrix. Further, we explicitly model
the non-diagonal variance-covariance matrix of the measurement error
<span class="math inline">\(\mathbf{\xi}_t\)</span> (for more details
see <span class="citation">Franjic and Schweikert (2024)</span>).</p>
</div>
<div id="features" class="section level2">
<h2>Features</h2>
<p>As this is an early beta version of the package, only a limited set
of functions is currently available. Additional functions, such as
validation wrappers, may be added in future updates.</p>
<ul>
<li><strong>Fast Model Simulation</strong>: The <code>simFM()</code>
function provides a flexible framework to simulate approximate
DFMs.</li>
<li><strong>FFast Model Estimation</strong>: The
<code>twoStepSDFM()</code> function provides a fast and convenient
implementation of the two-step estimator outlined in <span class="citation">Franjic and Schweikert (2024)</span>.</li>
<li><strong>Compatibility</strong>: All functions take advantage of
<code>C++</code> for enhanced speed.</li>
<li><strong>Open-Source</strong>: Distributed under the GNU General
Public License v3.0.</li>
</ul>
</div>
<div id="prerequisites" class="section level2">
<h2>Prerequisites</h2>
<ul>
<li><strong>Eigen</strong> (version 3.4.0 or later): A <code>C++</code>
template library for linear algebra <span class="citation">(Guennebaud,
Jacob, et al. 2010)</span>. <a href="https://eigen.tuxfamily.org/">Eigen
Website</a></li>
<li><strong>Rcpp</strong>: A package for integrating <code>C++</code>
code into <code>R</code> <span class="citation">(Eddelbuettel and
François 2011)</span>. <a href="https://cran.r-project.org/web/packages/Rcpp/index.html">Rcpp CRAN
repository</a></li>
<li><strong>RcppEigen</strong>: A package for integrating the
<code>Eigen</code> linear algebra library into <code>R</code> <span class="citation">(Bates and Eddelbuettel 2013)</span>. <a href="https://cran.r-project.org/web/packages/RcppEigen/index.html">RcppEigen
CRAN repository</a></li>
</ul>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>Currently, the package source files come with a zipped version of
<code>Eigen3</code>. <code>Rcpp</code> and <code>RcppEigen</code> can be
downloaded from CRAN or directly installed from within <code>R</code>by
calling <code>install.packages(&quot;...&quot;)</code>.</p>
<p>To install the package itself, a short <code>R</code> script is
provided (see <code>PackageBuilder.R</code>). The routine simply
calls</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">system</span>(<span class="st">&quot;R CMD INSTALL --preclean --no-multiarch --no-test-load .&quot;</span>)</span></code></pre></div>
<p>to compile and install the functions.</p>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<div id="simfm-simulating-a-dynamic-factor-model" class="section level3">
<h3><code>simFM()</code> – Simulating a dynamic factor model</h3>
<div id="parameters" class="section level4">
<h4>Parameters</h4>
<ul>
<li><code>T</code> – Number of observations</li>
<li><code>N</code> – Number of variables</li>
<li><code>R</code> – Number of factors</li>
<li><code>Sigma_epsilon</code> – Variance-covariance matrix of the
transition errors</li>
<li><code>Lambda</code> – Factor loadings matrix</li>
<li><code>mu_xi</code> – Mean of the measurement error</li>
<li><code>Sigma_xi</code> – Variance-covariance matrix of the
measurement error</li>
<li><code>Phi</code> – Factor VAR coefficient matrix (either a list of
length <span class="math inline">\(P\)</span> of <span class="math inline">\((R\times R)\)</span> matrices or a matrix of
dimensions <span class="math inline">\((R\times RP)\)</span>)</li>
<li><code>P</code> – Order of the factor VAR process</li>
<li><code>quarterfy</code> – Indicating whether or not some of the
variables should be aggregated to quarterly observations (i.e.,
quarterfied)</li>
<li><code>corr</code> – Indicating whether or not the measurement error
should be internatlly, randomly, cross-crossectionally correlated
(default is <code>FALSE</code>)</li>
<li><code>beta_param</code> – Beta parameter governing the degree of
correlation of the measurement error (default is <code>Inf</code>, i.e.,
disabled)</li>
<li><code>m</code> – Ratio of monthly predictors ought to be quarterfied
(default is <code>0</code>)</li>
<li><code>seed</code> – Seed for everything random (default is
<code>20022024</code>)</li>
<li><code>burn_in</code> – Burn-in period (default is
<code>1000</code>)</li>
<li><code>rescale</code> – Indicating whether the variance of the
measurement error should be scaled according to the variance of the
common-component (default is <code>TRUE</code>)</li>
<li><code>check_stationarity</code> – Indicating whether the factor VAR
process should be checked for stationarity (default is
<code>FALSE</code>)</li>
<li><code>stationarity_check_threshold</code> – Threshold for checking
for a unit root (default is <code>1e-5</code>)</li>
</ul>
</div>
<div id="example" class="section level4">
<h4>Example</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># Draw from an approximate mixed frequency factor model</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">600</span> <span class="co"># Number of observations</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Number of variabes</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Number of factors</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>Sigma_epsilon <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, R) <span class="co"># Variance-covariance matrix of the transition errors</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>Lambda <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(N <span class="sc">*</span> R), N, R) <span class="co"># Factor loadings matrix</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>mu_xi <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N) <span class="co"># Mean of the measurement error</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>Sigma_xi <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, N) <span class="co"># Variance-covariance matrix of the measurement error</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>Phi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(<span class="fl">0.5</span>, R), <span class="sc">-</span><span class="fu">diag</span>(<span class="fl">0.25</span>, R)) <span class="co"># Factor VAR coefficient matrix</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Order of the factor VAR process</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>quarterfy <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Indicating whether or not some of the variables should be aggregated to quarterly observations (i.e., quarterfied)</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>corr <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Indicating whether or not the measurement error should be internatlly cross-crossectionally correlated</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>beta_param <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Beta parameter governing the degree of correlation of the measurement error</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">0.03</span> <span class="co"># Ratio of monthly predictors ought to be quarterfied</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="dv">16022024</span> <span class="co"># Seed</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co"># Burn-in period</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>rescale <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Indicating whether the variance of the measurement error should be scaled according to the variance of the common-component </span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co"># Draw data</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>FM_mf <span class="ot">&lt;-</span> <span class="fu">simFM</span>(<span class="at">T =</span> T, <span class="at">N =</span> N, <span class="at">R =</span> R, <span class="at">Lambda =</span> Lambda, <span class="at">mu_xi =</span> mu_xi, <span class="at">Sigma_xi =</span> Sigma_xi,</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>            <span class="at">Sigma_epsilon =</span> Sigma_epsilon, <span class="at">Phi =</span> Phi, <span class="at">P =</span> P, <span class="at">quarterfy =</span> quarterfy, <span class="at">m =</span> m,</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>            <span class="at">corr =</span> corr, <span class="at">beta_param =</span> beta_param, <span class="at">seed =</span> seed, <span class="at">burn_in =</span> burn_in, <span class="at">rescale =</span> rescale)</span></code></pre></div>
</div>
</div>
<div id="twostepsdfm-estimating-the-model-parameters-and-higher-frequency-factors" class="section level3">
<h3><code>TwoStepSDFM()</code> – Estimating the model parameters and
higher-frequency factors</h3>
<div id="parameters-1" class="section level4">
<h4>Parameters</h4>
<ul>
<li><code>X</code> – <span class="math inline">\((N\times T)\)</span>
matrix of observations</li>
<li><code>delay</code> – <span class="math inline">\((N \times
1)\)</span> vector of publication lag (in months)</li>
<li><code>selected</code> – <span class="math inline">\((R\times
1)\)</span> vector of the number of non-zero loadings for each
factor</li>
<li><code>R</code> – Number of factors</li>
<li><code>P</code> – Maximum lag length of the factor VAR processes
(default is <code>10</code>)</li>
<li><code>decorr_errors</code> – Indicating whether the measurement
error should be treated as cross-sectionally correlated (default is
<code>TRUE</code>)</li>
<li><code>crit</code> – Information criterion to choose the factor VAR
process lag length (available are <code>&quot;BIC&quot;</code>,
<code>&quot;AIC&quot;</code>, <code>&quot;HC&quot;</code>; default is
<code>&quot;BIC&quot;</code>)</li>
<li><code>l2</code> – Ridge penalty (default is <code>1e-6</code>)</li>
<li><code>l1</code> – <span class="math inline">\((R\times 1)\)</span>
vector of LASSO penalties for each factor when using LARS (default is
<code>NaN</code>,i.e., disabled and <code>selected</code> is used as
stopping criterion)</li>
<li><code>max_iterations</code> – Maximum number of iterations (default
is <code>1000</code>)</li>
<li><code>steps</code> – Maximum number of steps when using the LARS
algorithm (default is <code>NaN</code>, i.e., disabled and
<code>selected</code> is used as stopping criterion)</li>
<li><code>comp_null</code> – Computational zero (default is
<code>1e-15</code>)</li>
<li><code>check_rank</code> – Indicating whether to check the rank of
the variance-covariance matrix of the data (default is
<code>FALSE</code>)</li>
<li><code>conv_crit</code> – Conversion criterion for the iterative SPCA
algorithm (default is <code>1e-4</code>)</li>
<li><code>conv_threshold</code> – Conversion threshold when using
coordinate descent (default is <code>1e-4</code>)</li>
<li><code>log</code> – Indicating whether to print output for monitoring
purposes (default is <code>FALSE</code>)</li>
</ul>
</div>
<div id="example-1" class="section level4">
<h4>Example</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># Simulate a DGP using simFM</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">600</span> <span class="co"># Number of observations</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Number of variabes</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Number of factors</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>Sigma_epsilon <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, R) <span class="co"># Variance-covariance matrix of the transition errors</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>Lambda <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(N <span class="sc">*</span> R), N, R) <span class="co"># Factor loadings matrix</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>mu_xi <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N) <span class="co"># Mean of the measurement error</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>Sigma_xi <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span>, N) <span class="co"># Variance-covariance matrix of the measurement error</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>Phi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(<span class="fl">0.5</span>, R), <span class="sc">-</span><span class="fu">diag</span>(<span class="fl">0.25</span>, R)) <span class="co"># Factor VAR coefficient matrix</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Order of the factor VAR process</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>quarterfy <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># Indicating whether or not some of the variables should be aggregated to quarterly observations (i.e., quarterfied)</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>corr <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Indicating whether or not the measurement error should be internatlly cross-crossectionally correlated</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>beta_param <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Beta parameter governing the degree of correlation of the measurement error</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="dv">16022024</span> <span class="co"># Seed</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co"># Burn-in period</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>rescale <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Indicating whether the variance of the measurement error should be scaled according to the variance of the common-component </span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co"># Draw the FM object</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>FM <span class="ot">&lt;-</span> <span class="fu">simFM</span>(<span class="at">T =</span> T, <span class="at">N =</span> N, <span class="at">R =</span> R, <span class="at">Lambda =</span> Lambda, <span class="at">mu_xi =</span> mu_xi, <span class="at">Sigma_xi =</span> Sigma_xi,</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>            <span class="at">Sigma_epsilon =</span> Sigma_epsilon, <span class="at">Phi =</span> Phi, <span class="at">P =</span> P, <span class="at">quarterfy =</span> quarterfy, <span class="at">m =</span> m,</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>            <span class="at">corr =</span> corr, <span class="at">beta_param =</span> beta_param, <span class="at">seed =</span> seed, <span class="at">burn_in =</span> burn_in, <span class="at">rescale =</span> rescale,</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>            <span class="at">check_staionarity =</span> <span class="cn">TRUE</span>, <span class="at">stationarity_check_threshold =</span> <span class="fl">1e-10</span>)</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co"># Fitting a sparse model with l2 regularisation and non-orthogonal measurement errors</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>selected <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">round</span>(N <span class="sc">*</span> <span class="fl">0.8</span>), <span class="fu">round</span>(N <span class="sc">*</span> <span class="fl">0.75</span>))</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>delay <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(N, <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>fit_sparse <span class="ot">&lt;-</span> <span class="fu">twoStepSDFM</span>(FM<span class="sc">$</span>X, delay, selected, R, <span class="at">l2 =</span> <span class="fl">1e+4</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="license" class="section level2">
<h2>License</h2>
<p><a href="LICENSE"><img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iOTYiIGhlaWdodD0iMjAiIHJvbGU9ImltZyIgYXJpYS1sYWJlbD0iTGljZW5zZTogR1BMdjMiPjx0aXRsZT5MaWNlbnNlOiBHUEx2MzwvdGl0bGU+PGxpbmVhckdyYWRpZW50IGlkPSJzIiB4Mj0iMCIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2JiYiIgc3RvcC1vcGFjaXR5PSIuMSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1vcGFjaXR5PSIuMSIvPjwvbGluZWFyR3JhZGllbnQ+PGNsaXBQYXRoIGlkPSJyIj48cmVjdCB3aWR0aD0iOTYiIGhlaWdodD0iMjAiIHJ4PSIzIiBmaWxsPSIjZmZmIi8+PC9jbGlwUGF0aD48ZyBjbGlwLXBhdGg9InVybCgjcikiPjxyZWN0IHdpZHRoPSI1MSIgaGVpZ2h0PSIyMCIgZmlsbD0iIzU1NSIvPjxyZWN0IHg9IjUxIiB3aWR0aD0iNDUiIGhlaWdodD0iMjAiIGZpbGw9IiMwMDdlYzYiLz48cmVjdCB3aWR0aD0iOTYiIGhlaWdodD0iMjAiIGZpbGw9InVybCgjcykiLz48L2c+PGcgZmlsbD0iI2ZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IlZlcmRhbmEsR2VuZXZhLERlamFWdSBTYW5zLHNhbnMtc2VyaWYiIHRleHQtcmVuZGVyaW5nPSJnZW9tZXRyaWNQcmVjaXNpb24iIGZvbnQtc2l6ZT0iMTEwIj48dGV4dCBhcmlhLWhpZGRlbj0idHJ1ZSIgeD0iMjY1IiB5PSIxNTAiIGZpbGw9IiMwMTAxMDEiIGZpbGwtb3BhY2l0eT0iLjMiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSI0MTAiPkxpY2Vuc2U8L3RleHQ+PHRleHQgeD0iMjY1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiBmaWxsPSIjZmZmIiB0ZXh0TGVuZ3RoPSI0MTAiPkxpY2Vuc2U8L3RleHQ+PHRleHQgYXJpYS1oaWRkZW49InRydWUiIHg9IjcyNSIgeT0iMTUwIiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzUwIj5HUEx2MzwvdGV4dD48dGV4dCB4PSI3MjUiIHk9IjE0MCIgdHJhbnNmb3JtPSJzY2FsZSguMSkiIGZpbGw9IiNmZmYiIHRleHRMZW5ndGg9IjM1MCI+R1BMdjM8L3RleHQ+PC9nPjwvc3ZnPg==" alt="License: GPL v3" /></a></p>
<p>© 2024 Domenic Franjic</p>
<p>This project is licensed under the <strong>GNU General Public License
v3.0</strong>. See the <a href="LICENSE">LICENSE</a> file for
details.</p>
</div>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>This work is partially based on the LARS-EN and SPCA algorithms found
in <span class="citation">Zou and Hastie (2020)</span>.</p>
</div>
<div id="contributing" class="section level2">
<h2>Contributing</h2>
<p>Contributions are welcome! Please open an issue or submit a pull
request for any improvements or bug fixes.</p>
<p><strong>To Contribute:</strong></p>
<ol style="list-style-type: decimal">
<li>Fork the repository.</li>
<li>Create a new branch for your feature or bug fix.</li>
<li>Commit your changes with descriptive messages.</li>
<li>Push to your fork and submit a pull request.</li>
</ol>
</div>
<div id="support" class="section level2">
<h2>Support</h2>
<p>If you have any questions or need assistance, please open an issue on
the GitHub repository or contact us via email.</p>
</div>
<div id="contact" class="section level2">
<h2>Contact</h2>
<ul>
<li><strong>Name</strong>: Domenic Franjic</li>
<li><strong>Institution</strong>: University of Hohenheim</li>
<li><strong>Department</strong>: Econometrics and Statistics, Core
Facility Hohenheim</li>
<li><strong>E-Mail</strong>: <a href="mailto:franjic@uni-hohenheim.de" class="email">franjic@uni-hohenheim.de</a></li>
</ul>
<div id="references" class="section level3 unnumbered">
<h3 class="unnumbered">References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bates2013EcppEigen" class="csl-entry">
Bates, Douglas, and Dirk Eddelbuettel. 2013. <span>“Fast and Elegant
Numerical Linear Algebra Using the <span>RcppEigen</span>
Package.”</span> <em>Journal of Statistical Software</em> 52 (5): 1–24.
<a href="https://doi.org/10.18637/jss.v052.i05">https://doi.org/10.18637/jss.v052.i05</a>.
</div>
<div id="ref-Doz2011Two_step" class="csl-entry">
Doz, Catherine, Domenico Giannone, and Lucrezia Reichlin. 2011.
<span>“<span class="nocase">A two-step estimator for large approximate
dynamic factor models based on Kalman filtering</span>.”</span>
<em>Journal of Econometrics</em> 164 (1): 188–205. <a href="https://doi.org/10.1016/j.jeconom.2011.02.012">https://doi.org/10.1016/j.jeconom.2011.02.012</a>.
</div>
<div id="ref-Eddelbuettel2011Rcpp" class="csl-entry">
Eddelbuettel, Dirk, and Romain François. 2011. <span>“<span>Rcpp</span>:
Seamless <span>R</span> and <span>C++</span> Integration.”</span>
<em>Journal of Statistical Software</em> 40 (8): 1–18. <a href="https://doi.org/10.18637/jss.v040.i08">https://doi.org/10.18637/jss.v040.i08</a>.
</div>
<div id="ref-franjic2024nowcasting" class="csl-entry">
Franjic, Domenic, and Karsten Schweikert. 2024. <span>“Nowcasting
Macroeconomic Variables with a Sparse Mixed Frequency Dynamic Factor
Model.”</span> <em>Available at SSRN</em>.
</div>
<div id="ref-Giannone2008Nowcasting" class="csl-entry">
Giannone, Domenico, Lucrezia Reichlin, and David Small. 2008.
<span>“Nowcasting: The Real-Time Informational Content of Macroeconomic
Data.”</span> <em>Journal of Monetary Economics</em> 55 (4): 665–76. <a href="https://doi.org/10.1016/j.jmoneco.2008.05.010">https://doi.org/10.1016/j.jmoneco.2008.05.010</a>.
</div>
<div id="ref-eigenweb" class="csl-entry">
Guennebaud, Gaël, Benoît Jacob, et al. 2010. <span>“Eigen V3.”</span>
http://eigen.tuxfamily.org.
</div>
<div id="ref-koopman2000fast" class="csl-entry">
Koopman, Siem Jan, and James Durbin. 2000. <span>“Fast Filtering and
Smoothing for Multivariate State Space Models.”</span> <em>Journal of
Time Series Analysis</em> 21 (3): 281–96.
</div>
<div id="ref-Zou2020elasticnet" class="csl-entry">
Zou, Hui, and Trevor Hastie. 2020. <em>Elasticnet: Elastic-Net for
Sparse Estimation and Sparse PCA</em>. <a href="https://CRAN.R-project.org/package=elasticnet">https://CRAN.R-project.org/package=elasticnet</a>.
</div>
<div id="ref-zou2006sparse" class="csl-entry">
Zou, Hui, Trevor Hastie, and Robert Tibshirani. 2006. <span>“Sparse
Principal Component Analysis.”</span> <em>Journal of Computational and
Graphical Statistics</em> 15 (2): 265–86.
</div>
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
